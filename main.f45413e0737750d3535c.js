(()=>{"use strict";var e="";const t=[{name:"Yosemite Valley",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/yosemite.jpg",alt:"Yosemite Valley"},{name:"Lake Louise",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lake-louise.jpg",alt:"Lake Louise"},{name:"Bald Mountains",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/bald-mountains.jpg",alt:"Bald Mountains"},{name:"Latemar",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/latemar.jpg",alt:"Latemar"},{name:"Vanoise National Park",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/vanoise.jpg",alt:"Vanoise National Park"},{name:"Lago di Braies",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lago.jpg",alt:"Lago di Braies"}],n={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__save-button",inactiveButtonClass:"popup__save-button_disabled",inputErrorClass:"popup__input-type-error",errorClass:"popup__input-error_visible"};console.log("initialCards:",t),console.log("validationConfig:",n);class s{constructor(e){this._popup=document.querySelector(e),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._popup.addEventListener("click",(e=>{(e.target.classList.contains("popup")||e.target.classList.contains("popup__close-button"))&&this.close()}))}}class o extends s{constructor(e,t){super(e),this._handleFormSubmit=t,this._form=this._popup.querySelector(".popup__form"),this._inputList=Array.from(this._form.querySelectorAll(".popup__input")),this._submitButton=this._form.querySelector(".popup__save-button"),this._defaultSubmitText=this._submitButton.textContent}setInputValues(e){console.log("Setting input values with data:",e),this._inputList.forEach((t=>{t.value=e[t.name]}))}_getInputValues(){const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault();const t=this._getInputValues(),n=this._handleFormSubmit(t);n instanceof Promise?n.then((()=>{this._form.reset()})).catch((e=>{console.error(e)})):this._form.reset()}))}open(){super.open()}}class r{constructor(e,t,n){this._data=e,this._templateSelector=t,this._handleCardClick=n}_getTemplate(){return document.querySelector(this._templateSelector).content.querySelector(".card").cloneNode(!0)}generateCard(){return this._element=this._getTemplate(),this._cardImage=this._element.querySelector(".card__image"),this._cardTitle=this._element.querySelector(".card__title"),this._likeButton=this._element.querySelector(".card__heart"),this._deleteButton=this._element.querySelector(".card__delete-button"),this._cardImage.src=this._data.link,this._cardImage.alt=this._data.name,this._cardTitle.textContent=this._data.name,this._setEventListeners(),this._element}_handleDeleteClick(){this._element.remove()}_handleLikeClick(){this._likeButton.classList.toggle("card__heart_active")}_isCardLiked(){return this._likeButton.classList.contains("card__heart_active")}_setEventListeners(){this._cardImage.addEventListener("click",(()=>{this._handleCardClick(this._data)})),this._likeButton.addEventListener("click",(()=>{this._handleLikeClick()})),this._deleteButton.addEventListener("click",(()=>{this._handleDeleteClick()}))}}class i{constructor(e,t){this._config=e,this._formElement=t,this._inputList=Array.from(this._formElement.querySelectorAll(this._config.inputSelector)),this._buttonElement=this._formElement.querySelector(this._config.submitButtonSelector)}_showInputError(e,t){const n=this._formElement.querySelector(`#${e.id}-error`);e.classList.add(this._config.inputErrorClass),n.textContent=t,n.classList.add(this._config.errorClass)}_hideInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.remove(this._config.inputErrorClass),t.classList.remove(this._config.errorClass),t.textContent=""}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}_toggleButtonState(){this._hasInvalidInput()?(this._buttonElement.disabled=!0,this._buttonElement.classList.add(this._config.inactiveButtonClass)):(this._buttonElement.disabled=!1,this._buttonElement.classList.remove(this._config.inactiveButtonClass))}_setEventListeners(){this._toggleButtonState(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}resetValidation(){this._inputList.forEach((e=>{this._hideInputError(e)})),this._toggleButtonState()}}const a=e+"8ec5e3f3631a809fd255.jpg",l=e+"4e8e0a1d604782a0dff8.svg";document.querySelector(".header__logo").src=l,document.querySelector(".profile__image").src=a,document.querySelector(".header__logo").addEventListener("load",(()=>{})),document.querySelector(".profile__image").addEventListener("load",(()=>{}));const c=new class{constructor({items:e,renderer:t},n){this._items=e,this._renderer=t,this._container=document.querySelector(n)}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}({items:t,renderer:e=>{const t=y(e);c.addItem(t)}},".cards"),u=new class{constructor({nameSelector:e,aboutSelector:t,avatarSelector:n}){this._nameElement=document.querySelector(e),this._aboutElement=document.querySelector(t),this._avatarElement=document.querySelector(n)}getUserInfo(){return{name:this._nameElement.textContent,about:this._aboutElement.textContent,avatar:this._avatarElement.src}}setUserInfo({name:e,about:t,avatar:n}){this._nameElement.textContent=e,this._aboutElement.textContent=t,n&&(this._avatarElement.src=n)}}({nameSelector:".profile__name",aboutSelector:".profile__about",avatarSelector:".profile__image"}),d=(document.getElementById("add-popup"),document.forms["add-form"]),_=(d.querySelector("#place"),d.querySelector("#link"),document.getElementById("edit-popup"),document.querySelector("#name")),p=document.querySelector("#about"),m=(document.querySelector(".profile__name"),document.querySelector(".profile__about"),document.querySelector(".profile__add-button")),h=document.querySelector(".profile__edit-button"),g=new class extends s{constructor(e){super(e),this._image=this._popup.querySelector(".popup__image"),this._caption=this._popup.querySelector(".popup__caption")}open(e){this._image.src=e.link,this._image.alt=e.name,this._caption.textContent=e.name,super.open()}}("#image-popup"),f=new o("#edit-popup",(function(e){u.setUserInfo({name:e.name,about:e.about}),f.close()})),E=new o("#add-popup",(function(e){const t=y(e);c.addItem(t),E.close()}));function v(e){g.open(e)}g.setEventListeners(),f.setEventListeners(),E.setEventListeners(),h.addEventListener("click",(()=>{L["edit-form"].resetValidation();const e=u.getUserInfo();console.log("Current user info:",e),_.value=e.name,p.value=e.about,f.open()}));const L={};var S;function y(e){return new r(e,"#card-template",v).generateCard()}S=n,Array.from(document.querySelectorAll(S.formSelector)).forEach((e=>{const t=new i(S,e),n=e.getAttribute("name");L[n]=t,t.enableValidation()})),m.addEventListener("click",(()=>{console.log("Add button clicked"),L["add-form"].resetValidation(),E.open()})),document.addEventListener("DOMContentLoaded",(()=>{c.renderItems()})),window.addEventListener("load",(()=>{}))})();